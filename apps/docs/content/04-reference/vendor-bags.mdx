---
title: Vendor bags
description: Agent-specific metadata for lossless round-trips
---

# Vendor bags reference

<Callout type="info">
  **Solo developer?** You can skip this page. Vendor bags are for advanced
  multi-agent workflows where you need agent-specific metadata.
</Callout>

Vendor bags preserve agent-specific metadata for lossless round-trips between AlignTrue and agent formats.

> **See it in action:** Check out the [multi-agent example](https://github.com/AlignTrue/aligntrue/tree/main/examples/multi-agent) for vendor bag usage.

## What are vendor bags?

Vendor bags are namespaced fields in the `vendor` property that store agent-specific metadata. They enable:

- **Lossless round-trips:** Import from agent → edit → export to agent without losing metadata
- **Agent-specific hints:** Different AI hints or priorities per agent
- **Format preservation:** Keep agent-specific fields that don't map to AlignTrue's schema

**Example:**

```yaml
rules:
  - id: typescript-strict
    summary: Use TypeScript strict mode
    severity: error
    guidance: Enable strict mode in tsconfig.json
    vendor:
      cursor:
        ai_hint: "Check tsconfig.json and suggest strict options"
        priority: high
      claude:
        mode: "assistant"
```

## When to use vendor bags

### Use vendor bags for

**Agent-specific AI hints:**

```yaml
vendor:
  cursor:
    ai_hint: "Focus on TypeScript best practices"
  claude:
    context: "Emphasize code review perspective"
```

**Agent-specific priorities or modes:**

```yaml
vendor:
  cursor:
    priority: high
    quick_fix: true
  copilot:
    suggestions: "detailed"
```

**Metadata that doesn't fit AlignTrue's schema:**

```yaml
vendor:
  cursor:
    session: "dev-session-1"
    tags: ["experimental"]
```

### Don't use vendor bags for

**Core rule logic** - Use `guidance` field:

```yaml
# Bad
vendor:
  cursor:
    rule_text: "Always use const instead of let"

# Good
guidance: |
  Always use const instead of let for immutable variables.
```

**Severity levels** - Use `severity` field:

```yaml
# Bad
vendor:
  cursor:
    severity: "high"

# Good
severity: error
```

**File patterns** - Use `applies_to`:

```yaml
# Bad
vendor:
  cursor:
    files: ["**/*.ts"]

# Good
applies_to:
  patterns: ["**/*.ts"]
```

## Syntax

### Basic syntax

```yaml
rules:
  - id: example-rule
    summary: Example rule
    vendor:
      <agent-name>:
        <field>: <value>
```

### Multiple agents

```yaml
rules:
  - id: example-rule
    summary: Example rule
    vendor:
      cursor:
        ai_hint: "Cursor-specific hint"
      claude:
        mode: "assistant"
      copilot:
        suggestions: "conservative"
```

### Nested fields

```yaml
vendor:
  cursor:
    config:
      mode: "strict"
      options:
        - "check-types"
        - "check-syntax"
```

## Examples

### Example 1: Different AI hints per agent

Use case: Same rule, different hints for different agents.

```yaml
rules:
  - id: require-tests
    summary: All features must have tests
    severity: error
    applies_to:
      patterns: ["src/**/*.ts"]
    guidance: |
      Write unit tests for all new features.
      Test files should be co-located with source files.
    vendor:
      cursor:
        ai_hint: "Suggest test file path and basic test structure using Vitest"
        quick_fix: true
      claude:
        mode: "reviewer"
        context: "Emphasize test coverage and edge cases"
      copilot:
        suggestions: "detailed"
        examples: true
```

**Result:**

- All agents enforce the rule
- Cursor gets quick fix suggestions
- Claude focuses on review perspective
- Copilot provides detailed examples

### Example 2: Agent-specific priorities

Use case: Different priority levels per agent.

```yaml
rules:
  - id: no-console-log
    summary: No console.log in production code
    severity: warn
    guidance: |
      Use proper logging library instead of console.log.
    vendor:
      cursor:
        priority: high # Show prominently in Cursor
        auto_fix: true
      claude:
        priority: medium # Less prominent in Claude
      copilot:
        priority: low # Background suggestion only
```

**Result:**

- Cursor shows the rule prominently with auto-fix
- Claude shows it with medium priority
- Copilot suggests it in background

### Example 3: Volatile fields

Use case: Exclude session IDs and timestamps from hashing.

```yaml
rules:
  - id: example-rule
    summary: Example rule
    vendor:
      cursor:
        session_id: "abc123" # Changes frequently
        timestamp: "2025-01-15" # Changes on every sync
      _meta:
        volatile: ["cursor.session_id", "cursor.timestamp"] # Exact agent.field paths only
```

**Result:**

- Session ID and timestamp preserved during round-trips
- But excluded from lockfile hashing
- Prevents false drift detection

## Volatile fields

Volatile fields are excluded from lockfile hashing to prevent false drift detection.

### Marking fields as volatile (exact paths only)

Use `vendor._meta.volatile` with **exact** `agent.field` paths. Wildcards are not supported.

```yaml
vendor:
  cursor:
    session_id: "abc123"
    timestamp: "2025-01-15"
    important_field: "keep-this"
  _meta:
    volatile: ["cursor.session_id", "cursor.timestamp"]
```

### Scope and limits

- Supported: exact first-level fields per agent, e.g., `cursor.session_id`, `claude.mode`.
- Not supported: wildcards or deep paths (e.g., `cursor.session.meta.id`). To exclude a nested object from hashing, mark the entire first-level key:

```yaml
vendor:
  _meta:
    volatile:
      - "cursor.session_meta"
```

### Quick verify workflow

1. Add exact paths under `vendor._meta.volatile`.
2. Run `aligntrue sync`.
3. Change only the volatile field (e.g., update a timestamp) and rerun `aligntrue sync`.
4. Confirm `.aligntrue/lock.json` is unchanged (`git diff` locally or `pnpm aligntrue drift --gates` in CI).

## Round-trip preservation

Vendor bags are preserved during:

### Export to agent

```bash
aligntrue sync
```

`vendor.cursor` namespace → Cursor-specific fields

### Sync operations

```bash
aligntrue sync
```

All vendor bags preserved in IR and agent files.

### What's preserved

**Preserved:**

- All fields in `vendor.<agent>` namespace
- Nested objects and arrays
- Custom metadata

**Not preserved:**

- Fields outside `vendor` namespace
- Fields marked as `volatile` (excluded from hashing only)

## Agent-specific fields

Common vendor bag fields by agent.

### Cursor

```yaml
vendor:
  cursor:
    ai_hint: string          # Hint for AI
    priority: "high" | "medium" | "low"
    quick_fix: boolean       # Enable quick fix
    session: string          # Session metadata
    tags: string[]           # Custom tags
```

**Example:**

```yaml
vendor:
  cursor:
    ai_hint: "Focus on TypeScript best practices"
    priority: high
    quick_fix: true
```

### Claude

```yaml
vendor:
  claude:
    mode: "assistant" | "reviewer" | "pair"
    context: string          # Context hint
    examples: boolean        # Include examples
```

**Example:**

```yaml
vendor:
  claude:
    mode: "reviewer"
    context: "Emphasize code quality and maintainability"
```

### Copilot

```yaml
vendor:
  copilot:
    suggestions: "conservative" | "balanced" | "detailed"
    examples: boolean        # Include examples
    priority: "high" | "medium" | "low"
```

**Example:**

```yaml
vendor:
  copilot:
    suggestions: "detailed"
    examples: true
```

### AGENTS.md (universal format)

```yaml
vendor:
  agents_md:
    original_severity: string # Original severity label
    section: string # Section heading
```

**Example:**

```yaml
vendor:
  agents_md:
    original_severity: "ERROR"
    section: "Code Quality"
```

### Other agents

For complete list of agent-specific fields, see:

- [Adding Exporters Guide](/docs/07-contributing/adding-exporters)
- Individual exporter source code in `packages/exporters/src/`

## Best practices

### 1. Use vendor bags sparingly

Only use vendor bags for truly agent-specific settings.

**Why:** Too many vendor bags make rules hard to maintain.

### 2. Keep core logic in guidance

Put rule logic in `guidance`, not vendor bags.

**Why:** Guidance is universal and works across all agents.

### 3. Document vendor bag usage

Add comments explaining why vendor bags are needed.

```yaml
rules:
  - id: example
    summary: Example
    # Cursor needs quick fix, Claude needs review context
    vendor:
      cursor:
        quick_fix: true
      claude:
        mode: "reviewer"
```

### 4. Mark volatile fields

Exclude session IDs and timestamps from hashing using exact paths.

```yaml
vendor:
  _meta:
    volatile: ["cursor.session_id", "cursor.timestamp"]
```

**Why:** Prevents false drift detection.

### 5. Test round-trips

Verify vendor bags are preserved during export:

```bash
# Export to agents
aligntrue sync

# Check preserved
diff .cursor/rules/original.mdc .cursor/rules/rule1.mdc
```

### 6. Edit sources, not exports

Make changes in `.aligntrue/rules/*.md` (source of truth). Files under `.cursor/` and `AGENTS.md` are read-only exports.

## Troubleshooting

### Vendor bags not preserved

**Problem:** Agent-specific fields lost after sync.

**Check:**

1. Verify vendor namespace:

```yaml
# Bad
cursor:
  ai_hint: "hint"

# Good
vendor:
  cursor:
    ai_hint: "hint"
```

2. Check exporter supports vendor bags:

```bash
aligntrue exporters list | grep cursor
```

### Lockfile always changes

**Problem:** Lockfile hash changes even though rules didn't change.

**Cause:** Non-volatile fields changing (timestamps, session IDs).

**Fix:** Mark fields as volatile:

```yaml
vendor:
  _meta:
    volatile: ["cursor.session_id", "cursor.timestamp"]
```

### Different behavior across agents

**Problem:** Agents behave differently despite same vendor bags.

**Expected:** Agents interpret vendor bags differently. Vendor bags are hints, not guarantees.

**Check fidelity notes:**

```bash
tail -20 .cursor/rules/*.mdc
```

## Related documentation

- [Multi-Agent Workflows](/docs/01-guides/05-multi-agent-workflows) - Using multiple agents
- [Quickstart](/docs/00-getting-started/00-quickstart) - Get started with AlignTrue
- [Adding Exporters](/docs/07-contributing/adding-exporters) - Creating exporters with vendor bags
- [Sync Behavior](/docs/03-concepts/sync-behavior) - Technical sync details

## Summary

**Vendor bags enable:**

- ✅ Lossless round-trips between AlignTrue and agents
- ✅ Agent-specific hints and priorities
- ✅ Metadata preservation

**Use vendor bags for:**

- ✅ Agent-specific AI hints
- ✅ Agent-specific priorities or modes
- ✅ Metadata that doesn't fit AlignTrue's schema

**Don't use vendor bags for:**

- ❌ Core rule logic (use `guidance`)
- ❌ Severity levels (use `severity`)
- ❌ File patterns (use `applies_to`)

**Key takeaway:** Vendor bags are powerful but should be used sparingly. Keep core rules consistent, use vendor bags only for truly agent-specific settings.
