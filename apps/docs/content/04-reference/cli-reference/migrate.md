---
description: Migrate from other tools like Ruler
---

# Migrate command

Migrate from other rule management tools like Ruler.

## Overview

The migrate command helps you transition from other rule management tools to AlignTrue. Currently supports migration from Ruler.

## Usage

```bash
aligntrue migrate <subcommand> [options]
```

## Subcommands

### `ruler` - Migrate from Ruler to AlignTrue

Automatically detects and converts Ruler configurations to AlignTrue format.

**What it does:**

1. Detects `.ruler/` directory and validates structure
2. Copies all `.ruler/*.md` files to `.aligntrue/rules/` (preserving directory structure)
3. Optionally includes `AGENTS.md` if it exists and wasn't generated by AlignTrue
4. Converts `ruler.toml` to `.aligntrue/config.yaml` (imports enabled exporters)
5. Optionally keeps `.ruler/` directory for reference

**Prerequisites:**

- `.ruler/` directory exists in current project
- At least one `.md` file in `.ruler/`

**Examples:**

```bash
# Interactive migration (prompts for confirmation)
aligntrue migrate ruler

# Migrate without prompts
aligntrue migrate ruler --yes

# Preview migration without making changes
aligntrue migrate ruler --dry-run
```

**Example output:**

```
Migrating from Ruler to AlignTrue

Copying files from .ruler/ to .aligntrue/rules/...
  ✓ 5 files copied

AGENTS.md found (not generated by AlignTrue)
? Include AGENTS.md in your rules? (y/N)

Note: .aligntrue/rules/ had existing files. Please review for duplicates.

Migration complete! Run "aligntrue sync" to export your rules to configured agents.
```

**Notes:**

- Ruler migration is also offered during `aligntrue init` if a `.ruler/` directory is detected
- Existing files in `.aligntrue/rules/` are preserved; review for duplicates
- The `.ruler/` directory can be kept for reference or removed

### `config` - Migrate from legacy single-file team config

Migrate from the legacy team configuration format (single `config.yaml` with `mode: team`) to the new two-file system (`config.team.yaml` + `config.yaml`).

**When to use:**

- You have an existing `.aligntrue/config.yaml` with `mode: team` (legacy team config)
- You want to upgrade to the new two-file configuration system
- Personal settings should be separated from team settings

**What it does:**

1. Detects legacy team configuration (`.aligntrue/config.yaml` with `mode: team` and no `config.team.yaml`)
2. Splits configuration into two files:
   - `.aligntrue/config.team.yaml` - Team settings (committed to git)
   - `.aligntrue/config.yaml` - Personal settings (gitignored)
3. Adds `config.yaml` to `.gitignore` under "AlignTrue Personal Config"
4. Moves team-only fields to `config.team.yaml`
5. Keeps shared and personal fields in `config.yaml`

**Examples:**

```bash
# Migrate legacy config
aligntrue migrate config

# Migrate without prompts
aligntrue migrate config --yes

# Preview changes without applying
aligntrue migrate config --dry-run
```

**Example output:**

```
Detected legacy team configuration

This will:
  1. Create .aligntrue/config.team.yaml with team settings
  2. Create .aligntrue/config.yaml with personal settings
  3. Add config.yaml to .gitignore

Continue? (y/N)

Migration complete!
  ✓ .aligntrue/config.team.yaml created
  ✓ .aligntrue/config.yaml updated
  ✓ .gitignore updated
```

**Configuration file mapping:**

| Setting                 | Destination        | Reason                                |
| ----------------------- | ------------------ | ------------------------------------- |
| `mode`, `modules.*`     | `config.team.yaml` | Team-only settings                    |
| `lockfile.*`            | `config.team.yaml` | Team-only settings                    |
| `remotes.personal`      | `config.yaml`      | Personal-only settings                |
| `sources`, `exporters`  | `config.yaml`      | Shared (both files merged additively) |
| `git`, `overlays`, etc. | `config.yaml`      | Shared settings (personal overrides)  |

**Notes:**

- The migration is non-destructive and preserves all settings
- Can be re-enabled later without re-running migration
- Team members can run this command independently

---

## Flags

| Flag          | Description                                        | Default |
| ------------- | -------------------------------------------------- | ------- |
| `--yes`, `-y` | Skip confirmation prompts (useful for automation)  | `false` |
| `--dry-run`   | Preview changes without applying any modifications | `false` |

---

## Exit codes

- `0` - Success
- `1` - Validation error (e.g., `.ruler/` not found)
- `2` - System error (permissions, disk space, etc.)

---

## Troubleshooting

### "No .ruler directory found" error

**Cause:** You're trying to run ruler migration but there's no `.ruler/` directory.

**Fix:**

1. Verify you're in the correct project directory
2. Check if rules are in a different location
3. If you don't have a `.ruler/` directory, start fresh with `aligntrue init`

---

## Remote backup

To backup your local rules to a remote git repository, configure `remote_backup` in your config:

```yaml
# .aligntrue/config.yaml
remote_backup:
  default:
    url: git@github.com:yourusername/rules-backup.git
    branch: main
```

See [Personal Repository Setup](/docs/04-reference/personal-repo-setup) for details.

---

## See also

- [Personal Repository Setup](/docs/04-reference/personal-repo-setup) - Setting up remote backup
- [CLI Reference](/docs/04-reference/cli-reference) - All CLI commands
