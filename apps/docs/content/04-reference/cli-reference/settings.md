# Settings commands

Commands for managing configuration, privacy, and system settings.

## `aligntrue config show|edit`

Display or edit AlignTrue configuration.

**Usage:**

```bash
aligntrue config show   # Display active configuration
aligntrue config edit   # Open config in default editor
```

**What it does:**

**`show` subcommand:**

- Displays active mode (solo/team/enterprise)
- Shows effective configuration with defaults
- Lists enabled modules (lockfile, bundle, checks, mcp)
- Shows exporter configuration

**`edit` subcommand:**

- Opens `.aligntrue/config.yaml` in default editor
- Uses `$EDITOR` environment variable
- Falls back to `vi` on Unix, `notepad` on Windows

**Example output (show):**

```
AlignTrue Configuration
=======================

Mode: solo

Modules:
  lockfile: false
  bundle: false
  checks: true
  mcp: false

Exporters:
  - cursor
  - agents

Sync:
  scope_prefixing: true

Config file: .aligntrue/config.yaml
```

**Exit codes:**

- `0` - Success
- `1` - Config file not found
- `2` - Editor failed to open (edit subcommand)

**See also:** [Team Mode Guide](/docs/03-concepts/team-mode) for configuration options

---

## `aligntrue migrate`

Migrate rules between scopes, storage types, and from other tools like Ruler.

**Usage:**

```bash
aligntrue migrate <subcommand> [options]
```

**Subcommands:**

| Subcommand | Description                               |
| ---------- | ----------------------------------------- |
| `personal` | Move all personal rules to remote storage |
| `team`     | Move all team rules to remote storage     |
| `ruler`    | Migrate from Ruler to AlignTrue           |

**Flags:**

| Flag          | Description                      | Default |
| ------------- | -------------------------------- | ------- |
| `--yes`, `-y` | Skip confirmation prompts        | `false` |
| `--dry-run`   | Preview changes without applying | `false` |

**Ruler migration:**

Automatically detects and converts Ruler configurations:

1. Copies all `.ruler/*.md` files to `.aligntrue/rules/` (preserving structure)
2. Optionally includes `AGENTS.md` if it exists and wasn't generated by AlignTrue
3. Converts `ruler.toml` to `.aligntrue/config.yaml` (imports enabled exporters)
4. Optionally keeps `.ruler/` directory for reference

**Examples:**

```bash
# Migrate from Ruler
aligntrue migrate ruler

# Migrate without prompts
aligntrue migrate ruler --yes

# Preview migration
aligntrue migrate ruler --dry-run
```

**Note:** Ruler migration is also offered during `aligntrue init` if a `.ruler/` directory is detected.

**Example output:**

```
Migrating from Ruler to AlignTrue

Copying files from .ruler/ to .aligntrue/rules/...
  ✓ 5 files copied

AGENTS.md found (not generated by AlignTrue)
? Include AGENTS.md in your rules? (y/N)

Note: .aligntrue/rules/ had existing files. Please review for duplicates.

Migration complete! Run "aligntrue sync" to export your rules to configured agents.
```

**Exit codes:**

- `0` - Success
- `1` - Validation error (e.g., .ruler/ not found)
- `2` - System error

---

## `aligntrue telemetry on|off|status`

Control anonymous usage telemetry (opt-in only, disabled by default).

**Usage:**

```bash
aligntrue telemetry <command>
```

**Commands:**

- `on` - Enable telemetry collection
- `off` - Disable telemetry collection
- `status` - Show current telemetry status

**What we collect (when enabled):**

- Command names (`init`, `sync`, `check`, etc.)
- Export targets (`cursor`, `agents`, etc.)
- Rule hashes used (SHA-256, no content)
- Anonymous UUID (generated once)

**What we NEVER collect:**

- File paths or repo names
- Code or rule content
- Personal information
- Anything identifying you or your project

**Examples:**

```bash
# Check status
aligntrue telemetry status

# Enable collection
aligntrue telemetry on

# Disable collection
aligntrue telemetry off
```

**Output:**

```
Telemetry: Enabled
UUID: a3b2c1d4-e5f6-1234-5678-9abcdef01234

We collect:
  • Command names
  • Export targets
  • Rule hashes (no content)

We NEVER collect:
  • File paths or code
  • Personal information
```

**Storage:**

- State: `.aligntrue/telemetry.json`
- Events: `.aligntrue/telemetry-events.json` (last 1000 events)

---

## `aligntrue privacy audit|revoke`

Manage privacy consents for network operations.

**Usage:**

```bash
aligntrue privacy audit                    # List all consents
aligntrue privacy revoke <operation>       # Revoke specific consent
aligntrue privacy revoke --all             # Revoke all consents
```

**Commands:**

- `audit` - List all granted consents with timestamps
- `revoke git` - Revoke consent for git clones
- `revoke --all` - Revoke all consents (prompts for confirmation)

**How consent works:**

1. **First time** a network operation is needed (git source), you'll see a clear error
2. The error message explains what consent is needed and how to grant it
3. **After granting**, AlignTrue remembers and won't prompt again
4. **Revoke anytime** using `aligntrue privacy revoke`

**Examples:**

```bash
# List all consents
aligntrue privacy audit

# Revoke git consent
aligntrue privacy revoke git

# Revoke all consents with confirmation
aligntrue privacy revoke --all
```

**Audit output:**

```
Privacy Consents

  ✓ git        Granted Oct 29, 2025 at 11:45 AM

Use 'aligntrue privacy revoke <operation>' to revoke
```

**When no consents:**

```
No privacy consents granted yet

Network operations will prompt for consent when needed.
Run "aligntrue privacy audit" after granting consent to see details.
```

**Storage:**

- Consents: `.aligntrue/privacy-consent.json` (git-ignored)
- Per-machine, not committed to git
- Simple JSON format you can edit manually if needed

**Offline mode:**

Git sources support offline mode via `aligntrue sync --offline` to use cached repositories without network operations. See the [git workflows guide](/docs/03-concepts/git-workflows) for details.

**See also:**

- [Git workflows](/docs/03-concepts/git-workflows) - Git sources and offline mode

---

## Getting help

```bash
# Show all commands
aligntrue --help

# Show command-specific help
aligntrue sync --help
```

**Exit codes summary:**

- `0` - Success
- `1` - Validation error (user-fixable)
- `2` - System error (permissions, disk space, etc.)

---

## Error codes

AlignTrue uses standardized error codes for consistent debugging and support. All errors include:

- **Clear title and message** - What went wrong
- **Actionable hints** - Next steps to fix
- **Error codes** - Reference for support

### System errors (exit code 2)

These errors indicate missing files, permissions, or system issues:

- `ERR_CONFIG_NOT_FOUND` - Configuration file missing

  ```
  ✗ Config file not found

  Could not locate: .aligntrue/config.yaml

  Hint: Run 'aligntrue init' to create initial configuration

  Error code: ERR_CONFIG_NOT_FOUND
  ```

- `ERR_RULES_NOT_FOUND` - Rules file missing

  ```
  ✗ Rules file not found

  Could not locate: .aligntrue/rules

  Hint: Run 'aligntrue init' to create initial rules

  Error code: ERR_RULES_NOT_FOUND
  ```

- `ERR_FILE_WRITE_FAILED` - File I/O error

  ```
  ✗ File write failed

  Could not write to: .aligntrue/config.yaml

  Details:
    - Permission denied (EACCES)

  Hint: Check file permissions and disk space

  Error code: ERR_FILE_WRITE_FAILED
  ```

### Validation errors (exit code 1)

These errors indicate invalid configuration, rules, or data:

- `ERR_VALIDATION_FAILED` - Schema or rule validation failed

  ```
  ✗ Validation failed

  Errors in AGENTS.md

  Details:
    - spec_version: Missing required field
    - rules: Missing required field

  Hint: Fix the errors above and try again

  Error code: ERR_VALIDATION_FAILED
  ```

- `ERR_SYNC_FAILED` - Sync operation failed

  ```
  ✗ Sync failed

  Failed to load exporters: Handler not found

  Hint: Run 'aligntrue sync --help' for more options

  Error code: ERR_SYNC_FAILED
  ```

**See also:** [Troubleshooting Guide](/docs/05-troubleshooting) for common error solutions
