# AlignTrue Golden Repository

This repository demonstrates AlignTrue in action with a complete, working example that you can clone and run in under 60 seconds.

## What's Inside

- **`.aligntrue/config.yaml`** - Minimal solo mode configuration (2 lines)
- **`.aligntrue/rules`** - Internal IR file (auto-generated, don't edit directly)
- **`AGENTS.md`** - Primary user-editable file with 5 example rules
- **`.cursor/rules/*.mdc`** - Generated Cursor rules (one file per rule)
- **`.vscode/mcp.json`** - VS Code MCP configuration

## Solo developer workflow

This repository demonstrates the **rules-first workflow** for solo developers:

1. **Edit rules in `.aligntrue/rules/`**
2. **Save changes**
3. **Run sync** (exports to all configured agents)

No YAML knowledge required! The internal IR (`.aligntrue/rules`) is generated automatically.

## Quick start

### 1. Clone and Navigate

```bash
# From the aligntrue repo root
cd examples/golden-repo
```

### 2. View the Rules

```bash
cat AGENTS.md
```

You'll see 5 practical rules:

- Testing best practices (error severity)
- Code review guidance (warn)
- Documentation standards (info)
- Security practices (error)
- TypeScript style (warn, with Cursor vendor metadata)

### 3. Sync Rules to Agents

```bash
# From aligntrue repo root
node ../../packages/cli/dist/index.js sync
```

Expected output:

```
✓ Sync complete
Wrote 7 files:
  - .cursor/rules/testing.mdc
  - .cursor/rules/code-review.mdc
  - .cursor/rules/security.mdc
  - .cursor/rules/documentation.mdc
  - .cursor/rules/typescript.mdc
  - AGENTS.md
```

### 4. Inspect the Outputs

**Cursor Rules:**

```bash
ls -la .cursor/rules/
cat .cursor/rules/*.mdc
```

**Universal Format:**

```bash
cat AGENTS.md
```

**VS Code MCP Config:**

```bash
cat .vscode/mcp.json
```

Each output includes:

- All 5 rules in agent-specific format
- Content hash for integrity verification
- Fidelity notes explaining any format limitations

## Edit → Sync Workflow

### 1. Edit Rules

Edit rules in `.aligntrue/rules/` (markdown files). The `AGENTS.md` file is auto-generated by `aligntrue sync` from your rules.

### 2. Sync Changes

```bash
node ../../packages/cli/dist/index.js sync
```

### 3. Verify Updates

```bash
# Check that outputs changed
git diff .cursor/rules/ .aligntrue/rules
```

The content hashes will update automatically, and the internal IR (`.aligntrue/rules`) will be regenerated.

## Advanced features

### Dry run mode

Preview changes without writing files:

```bash
node ../../packages/cli/dist/index.js sync --dry-run
```

### Configuration

The `.aligntrue/config.yaml` shows a minimal solo mode setup:

```yaml
version: "1"
mode: solo

sources:
  - type: local
    path: .aligntrue/rules

exporters:
  - cursor
  - agents
  - vscode-mcp

git:
  mode: ignore
```

**Note:** The `sources` path points to `.aligntrue/rules` (internal IR). Users should edit rules in `.aligntrue/rules/`. The IR is auto-generated during sync.

### Rule format

Each rule in `AGENTS.md` includes:

- `ID`: Unique identifier (dot notation, e.g., `testing.require.tests`)
- `Severity`: ERROR, WARN, or INFO (uppercase in AGENTS.md)
- `Scope`: File patterns the rule applies to
- `Guidance`: Markdown-formatted explanation with examples

## Expected performance

- **Initial sync**: <5 seconds for 5 rules + 3 exporters
- **File generation**: 3 files totaling ~6KB
- **Deterministic**: Same inputs → same outputs → same hashes

## Validation

Run the validation script to verify everything works:

```bash
./test-golden-repo.sh
```

This checks:

- Config file exists and is valid
- Rules file exists and validates
- Sync succeeds
- All 3 output files are created
- Content hashes are present

## What's next

- **Try overlays**: See [overlays-demo](../overlays-demo/) for fork-safe customization
- **Try scopes**: See [monorepo-scopes](../monorepo-scopes/) for path-based rules
- **Try multi-agent**: See [multi-agent](../multi-agent/) for syncing to multiple agents

## Related examples

- **[Overlays demo](../overlays-demo/)** - Fork-safe customization without forking
- **[Monorepo scopes](../monorepo-scopes/)** - Path-based rules for monorepos
- **[Multi-agent](../multi-agent/)** - Same rules, multiple agents
- **[Multi-file rules](../multi-file-rules/)** - Organize rules across multiple markdown files

## Learn more

- [AlignTrue documentation](https://aligntrue.ai/docs)
- [CLI reference](https://aligntrue.ai/docs/04-reference/cli-reference)
- [Sync behavior](https://aligntrue.ai/docs/03-concepts/sync-behavior)
